#!/bin/sh

case $BLOCK_BUTTON in
    1) setsid -f $TERMINAL -e pulsemixer ;;
    3) pamixer -t ;;
    4) pamixer -i 5 ;;
    5) pamixer -d 5 ;;
esac

case $1 in
    toggle) pamixer -t; pkill -SIGRTMIN+3 dwmblocks || pkill -SIGRTMIN+3 i3blocks ;;
    mute) pamixer -m; pkill -SIGRTMIN+3 dwmblocks || pkill -SIGRTMIN+3 i3blocks ;;
    unmute) pamixer -u; pkill -SIGRTMIN+3 dwmblocks || pkill -SIGRTMIN+3 i3blocks ;;
    up) pamixer -i 5; pkill -SIGRTMIN+3 dwmblocks || pkill -SIGRTMIN+3 i3blocks ;;
    down) pamixer -d 5; pkill -SIGRTMIN+3 dwmblocks || pkill -SIGRTMIN+3 i3blocks ;;
esac

MUTED=$(pamixer --get-mute)
VOLUME=$(pamixer --get-volume)

if [ "$MUTED" = "true" ]; then
    printf "\n"
else
    printf " $VOLUME%%\n"
fi
